"use strict";(self.webpackChunkfar_blog=self.webpackChunkfar_blog||[]).push([[438],{6262:(i,s)=>{s.A=(i,s)=>{const a=i.__vccOpts||i;for(const[i,n]of s)a[i]=n;return a}},5507:(i,s,a)=>{a.r(s),a.d(s,{comp:()=>k,data:()=>t});var n=a(641);const h=[(0,n.Fv)('<h2 id="_1-目标文件的格式" tabindex="-1"><a class="header-anchor" href="#_1-目标文件的格式"><span>1. 目标文件的格式</span></a></h2><p>Linux下的主流文件存储格式为<mark>ELF</mark>，通过file指令可以查看文件的存储格式。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> foobar.o</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">foobar.o:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ELF</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 64-bit</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LSB</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> relocatable,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> x86-64,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (SYSV), not stripped</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /bin/bash</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/bin/bash:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ELF</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 64-bit</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LSB</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pie</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> executable,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> x86-64,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">BuildID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sha1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2f77b36371c214e11670c7d9d92727e9a49f626b,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GNU/Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 3.2.0,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> stripped</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /lib32/ld-linux.so.2</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/lib32/ld-linux.so.2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ELF</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 32-bit</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LSB</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shared</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> object,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Intel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 80386,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (GNU/Linux), static-pie linked, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">BuildID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sha1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">595f7870a8165b3eb04c9ebda08a8ccba6f742c2,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> stripped</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ELF文件标准里采用ELF格式的文件:</p><ul><li>可重定位文件<br> Linux的 *.o文件<br> 静态链接库</li><li>可执行文件</li><li>共享目标文件<br> Linux的 *.so文件</li><li>核心转储文件<br> Linux下的 core dump</li></ul><h2 id="_2-目标文件是什么样的" tabindex="-1"><a class="header-anchor" href="#_2-目标文件是什么样的"><span>2. 目标文件是什么样的</span></a></h2><p>目标文件将信息按不同的属性进行存储，通常称之为<mark>节(section)或者段(segment)</mark></p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>源代码编译后的机器指令经常放于代码段(.text)<br> 全局变量和局部静态变量经常存放于数据段(.data)</p></div><p><img src="/image/chapter02/程序与目标文件.png" alt="程序与目标文件" loading="lazy"><br> ELF文件的开头是一个“文件头”，描述了整个文件的文件属性。</p><ul><li>是否可执行</li><li>是否静态链接</li><li>是否动态链接</li><li>入口地址</li><li>目标硬件</li><li>目标操作系统</li><li>等等</li></ul><p>文件头同时包括一个段表</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>段表用来描述一个文件中各个段的数组。段表描述了文件中各个段在文件中的偏移位置及段的属性等，从段表中可以得到每个的段的所有信息。<br> .data section: 已初始化的全局变量和局部静态变量<br> .bss section: 未初始化的全局变量和局部静态变量(默认值为0),初始化为0的全局变量和局部静态变量<br> .bss段只是为未初始化的全局变量和局部静态变量预留位置而已(记录所有为初始或者初始化为0的全局变量和静态变量的大小总和)，所以在文件中也不占据空间</p></div><p>分段的好处</p><ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-0" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-0"> 可以防止程序被恶意篡改</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-1" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-1"> 利用缓存，提高CPU的缓存命中</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-2" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-2"> 节省内存空间(内存共享比如libc的动态链接库)</label></li></ul><h2 id="_3-挖掘simplesection-o" tabindex="-1"><a class="header-anchor" href="#_3-挖掘simplesection-o"><span>3. 挖掘SimpleSection.o</span></a></h2><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> printf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> global_init_var </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 84</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> global_uninit_var;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> func1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> i</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">printf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, i); }</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  static</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> static_var </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 85</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  static</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> static_var2;</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> b;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  func1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(static_var </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> static_var2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> b);</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>使用objdump -h指令打印ELF文件的各个段的基本信息<br> -x 参数可以打印更多信息</p></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">objdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SimpleSection.o:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> elf64-x86-64</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Sections:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Idx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          Size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      VMA</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">               LMA</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">               File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> off</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Algn</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .text</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         00000064</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000040</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">0</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ALLOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOAD,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RELOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> CODE</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .data</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         00000008</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000a4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ALLOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOAD,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DATA</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .bss</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">          00000008</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000ac</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  ALLOC</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .rodata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       00000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000ac</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">0</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ALLOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOAD,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DATA</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .comment</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      00000027</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000b0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">0</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .note.GNU-stack</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000d7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">0</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  6</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .note.gnu.property</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000020</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000d8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">3</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ALLOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOAD,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DATA</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .eh_frame</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     00000058</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000f8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">3</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ALLOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOAD,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RELOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DATA</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">注</p><p>.rodata: 只读数据段<br> .comment: 注释信息段<br> .note.GNU-stack: 堆栈提示段<br> Size: 段的长度<br> File Offset: 段所在的位置(段偏移)<br> CONTENTS: 该段在文件中存在(bss段没有表示bss段在ELF文件中不存在内容。.note.GNU-stack虽然有但是长度为0，认为它在ELF文件中也不存在)</p></div><p>使用<mark>size</mark>指令查看ELF文件的代码段、数据段和bss段。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   text</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    data</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     bss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     dec</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> filename</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    224</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     240</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      f0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-1-代码段" tabindex="-1"><a class="header-anchor" href="#_3-1-代码段"><span>3.1 代码段</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">objdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SimpleSection.o:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> elf64-x86-64</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .text:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> f30f1efa</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 554889e5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4883ec10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 897dfc8b</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ....UH..H....}..</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0010</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 45fc89c6</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 488d0500</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000048</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 89c7b800</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  E...H......H....</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0020</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 000000e8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 90c9c3f3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f1efa55</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ...............U</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0030</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4889e548</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 83ec10c7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 45f80100</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00008b15</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  H..H....E.......</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0040</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8b050000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 000001c2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8b45f801</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  .............E..</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0050</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c28b45fc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 01d089c7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> e8000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00b80000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ..E.............</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0060</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0000c9c3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                             ....</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .data:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 54000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 55000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                    T...U...</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .rodata:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 25640a00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                             %d..</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .comment:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00474343</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 3a202855</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 62756e74</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 75203133</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  .GCC:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (Ubuntu </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">13</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0010</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 2e322e30</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 2d323375</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 62756e74</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 75342920</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  .2.0-23ubuntu4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0020</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 31332e32</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 2e3000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      13.2.0.</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .note.gnu.property:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 04000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 05000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 474e5500</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ............GNU.</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0010</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 020000c0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 04000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 03000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ................</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .eh_frame:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 14000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 017a5200</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 01781001</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  .........zR..x..</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0010</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1b0c0708</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 90010000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1c000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1c000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ................</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0020</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 2b000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00450e10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8602430d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ....+....E....C.</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0030</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 06620c07</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 08000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1c000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 3c000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  .b..........</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">...</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0040</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 39000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00450e10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8602430d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ....9....E....C.</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0050</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 06700c07</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 08000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                    .p......</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disassembly</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .text:</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000000</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">func</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">1&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   0:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   f3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fa</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             endbr64</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   4:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   55</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      push</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   %rbp</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   5:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> e5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %rsp,%rbp</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   8:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 83</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ec</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             sub</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    $0x10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%rsp</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   c:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 7d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %edi,-0x4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">%rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   f:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   8b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 45</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    -0x4(%rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),%eax</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  12:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c6</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %eax,%esi</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  14:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8d</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 05</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    lea</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0x0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">%rip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%rax</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        # 1b &lt;func1+0x1b&gt;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  1b:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %rax,%rdi</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  1e:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   b8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    $0x0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%eax</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  23:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   e8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          call</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   28</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">func1+0x2</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">8&gt;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  28:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   90</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      nop</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  29:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   c9</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      leave</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  2a:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   c3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      ret</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">000000000000002b</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mai</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  2b:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   f3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fa</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             endbr64</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  2f:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   55</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      push</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   %rbp</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  30:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> e5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %rsp,%rbp</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  33:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 83</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ec</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             sub</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    $0x10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%rsp</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  37:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   c7</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 45</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> f8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 01</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    movl</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">   $0x1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,-0x8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">%rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  3e:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   8b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 15</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       mov</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0x0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">%rip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%edx</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        # 44 &lt;main+0x19&gt;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  44:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   8b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 05</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       mov</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0x0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">%rip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%eax</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        # 4a &lt;main+0x1f&gt;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  4a:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %eax,%edx</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  4c:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   8b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 45</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> f8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    -0x8(%rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),%eax</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  4f:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %eax,%edx</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  51:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   8b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 45</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    -0x4(%rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),%eax</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  54:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> d0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %edx,%eax</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  56:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %eax,%edi</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  58:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   e8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          call</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   5d</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">main+0x3</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">2&gt;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  5d:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   b8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    $0x0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%eax</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  62:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   c9</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      leave</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  63:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   c3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      ret</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>-s: 将所有段的内容以十六进制的方式打印<br> -d: 将所有包含指令的段反汇编</p></div><h3 id="_3-2-数据段和只读数据段" tabindex="-1"><a class="header-anchor" href="#_3-2-数据段和只读数据段"><span>3.2 数据段和只读数据段</span></a></h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>.data section: 已初始化的全局变量和局部静态变量</p></div><p>SimpleSection.c代码中一共有两个这样的变量(global_init_var, static_var),所以.data段的大小正好为8个字节。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>.rodata section: 存放只读数据(const变量,字符串字面量)</p></div><p>SimpleSection.c代码中用在调用printf时用到了字符字面量&quot;%d\\n&quot;,它是一种只读数据,所以它被放到了.rodata段。所以.rodata段的大小正好为四字节(字符串结尾包含字符串结束符)。</p><h3 id="_3-3-bss段" tabindex="-1"><a class="header-anchor" href="#_3-3-bss段"><span>3.3 bss段</span></a></h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>.bss section: 未初始化的全局变量和局部静态变量(默认值为0),初始化为0的全局变量和局部静态变量</p></div><p>SimpleSection.c代码中一共有两个这样的变量(global_uninit_var, static_var2),所以.data段的大小正好为8个字节。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>可以给gcc选项加入-fcommon使未初始化的全局变量被定义为一个&quot;COMMON&quot;符号，注意对于初始化为0的全局变量则不行。</p></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -fcommon</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">readelf</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Symbol</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;.symtab&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> contains</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 13</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> entries:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   Num:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Value</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          Size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Bind</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   Vis</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      Ndx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Name</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     0:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NOTYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  UND</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     1:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FILE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ABS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.c</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     2:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .text</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     3:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .data</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     4:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .bss</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     5:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .rodata</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     6:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var.1</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     7:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var2.0</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     8:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_init_var</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     9:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  COM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_uninit_var</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    10:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    43</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FUNC</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> func1</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    11:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NOTYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  UND</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> printf</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    12:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 000000000000002b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    57</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FUNC</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-其它段" tabindex="-1"><a class="header-anchor" href="#_3-3-其它段"><span>3.3 其它段</span></a></h3><figure><img src="/image/chapter02/其他段.png" alt="其它段" tabindex="0" loading="lazy"><figcaption>其它段</figcaption></figure><h2 id="_4-elf文件结构描述" tabindex="-1"><a class="header-anchor" href="#_4-elf文件结构描述"><span>4. ELF文件结构描述</span></a></h2><div class="hint-container note"><p class="hint-container-title">注</p><p>ELF目标文件的最前部是ELF文件头（ELF Header）,它包含了描述整个文件的基本属性。仅接着是ELF各个段。其中ELF文件中与段有关的重要结构就是段表（Section Header Table），该表描述了ELF文件包含的所有段的信息，比如每个段的段名、段的长度、在文件中的偏移、读写权限及段的其它属性。</p></div><figure><img src="/image/chapter02/ELF文件结构.png" alt="ELF文件结构" tabindex="0" loading="lazy"><figcaption>ELF文件结构</figcaption></figure><h3 id="_4-1-文件头" tabindex="-1"><a class="header-anchor" href="#_4-1-文件头"><span>4.1 文件头</span></a></h3><p>通过使用<mark>readelf -h</mark>指令即可查看ELF文件头</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">readelf</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ELF</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Header:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  Magic:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   7f</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 45</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4c</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 46</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 02</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 01</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 01</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  Class:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                             ELF64</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  Data:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">                              2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;s complement, little endian</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Version:                           1 (current)</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  OS/ABI:                            UNIX - System V</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ABI Version:                       0</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Type:                              REL (Relocatable file)</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Machine:                           Advanced Micro Devices X86-64</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Version:                           0x1</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Entry point address:               0x0</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Start of program headers:          0 (bytes into file)</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Start of section headers:          1032 (bytes into file)</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Flags:                             0x0</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Size of this header:               64 (bytes)</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Size of program headers:           0 (bytes)</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Number of program headers:         0</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Size of section headers:           64 (bytes)</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Number of section headers:         14</span></span>\n<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Section header string table index: 13</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ELF文件头定义了</p><ul><li>ELF魔数</li><li>文件机器字节长度</li><li>数据存储方式</li><li>版本</li><li>运行平台</li><li>ABI版本</li><li>ELF重定位类型</li><li>硬件平台</li><li>硬件平台版本</li><li>入口地址</li><li>程序入口和长度</li><li>段表位置和长度</li><li>段数量</li></ul><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// /usr/include/elf.h</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;">\te_ident</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[EI_NIDENT];</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t/* Magic number and other info */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half\te_type;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t\t/* Object file type */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half\te_machine;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Architecture */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word\te_version;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Object file version */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Addr\te_entry;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Entry point virtual address */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Off\te_phoff;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Program header table file offset */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Off\te_shoff;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section header table file offset */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word\te_flags;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Processor-specific flags */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half\te_ehsize;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* ELF header size in bytes */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half\te_phentsize;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Program header table entry size */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half\te_phnum;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Program header table entry count */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half\te_shentsize;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section header table entry size */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half\te_shnum;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section header table entry count */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half\te_shstrndx;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section header string table index */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} Elf64_Ehdr;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/image/chapter02/ELF文件头结构成员含义.png" alt="ELF文件头结构成员含义" tabindex="0" loading="lazy"><figcaption>ELF文件头结构成员含义</figcaption></figure><h4 id="_4-1-2-文件类型" tabindex="-1"><a class="header-anchor" href="#_4-1-2-文件类型"><span>4.1.2 文件类型</span></a></h4><figure><img src="/image/chapter02/文件类型.png" alt="文件类型" tabindex="0" loading="lazy"><figcaption>文件类型</figcaption></figure><h4 id="_4-1-3-机器类型" tabindex="-1"><a class="header-anchor" href="#_4-1-3-机器类型"><span>4.1.3 机器类型</span></a></h4><figure><img src="/image/chapter02/机器类型.png" alt="机器类型" tabindex="0" loading="lazy"><figcaption>机器类型</figcaption></figure><h3 id="_4-2-段表" tabindex="-1"><a class="header-anchor" href="#_4-2-段表"><span>4.2 段表</span></a></h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>段表用于保存这些段的基本属性结构。</p></div><p>使用<mark>objdump -h</mark>来查看ELF文件中包含的段，但是只是把ELF文件中关键的段显示了出来。可以使用<mark>readelf -S</mark>指令来显示ELF文件的各种段表结构</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">readelf</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">There</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 14</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> headers,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> starting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> offset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0x408:</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Headers:</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [Nr] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">              Type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             Address</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           Offset</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       Size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">              EntSize</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          Flags</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Link</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Info</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Align</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 0]                   </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">NULL</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">             0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000000</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 1] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.text</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000040</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000064</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  AX</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 2] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.rela.text</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        RELA</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">             0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000002e8</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000078</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000018</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   I</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      11</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 3] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.data</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000a4</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000008</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  WA</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 4] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.bss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">              NOBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000ac</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  WA</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 5] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.rodata</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000ac</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   A</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 6] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.comment</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000b0</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000027</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000001</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  MS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 7] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.note.GNU-stack</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000d7</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 8] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.note.gnu.pr[...]</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NOTE</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">             0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000d8</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000020</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   A</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 9] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.eh_frame</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000f8</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000058</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   A</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [10] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.rela.eh_frame</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    RELA</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">             0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000360</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000030</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000018</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   I</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      11</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     9</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [11] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.symtab</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           SYMTAB</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000150</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000138</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000018</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">          12</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [12] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.strtab</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           STRTAB</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000288</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000060</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [13] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.shstrtab</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         STRTAB</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000390</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000074</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Key</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Flags:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  W</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (write), A (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), X (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), M (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">merge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), S (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strings</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), I (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  L</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (link </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">order</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), O (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">extra</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> processing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> required</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), G (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), T (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">TLS</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  C</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (compressed), x (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">unknown</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), o (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">OS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> specific</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), E (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exclude</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  D</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (mbind), l (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">large</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), p (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">processor</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> specific</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>段表的结构以Elf64_Shdr结构的数组形式进行存储,数组元素个数为段个数，每个Elf64_Shdr对应一个段属性描述。所以每个Elf64_Shdr又被称为段描述符。<br> 第一个元素是无效段描述符，它的类型为&quot;NULL&quot;，除此之外每个描述符对应一个段。所以SimpleSection.o共有10个有效段。</p></div><h4 id="_4-2-1-段描述符的结构" tabindex="-1"><a class="header-anchor" href="#_4-2-1-段描述符的结构"><span>4.2.1 段描述符的结构</span></a></h4><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// /usr/include/elf.h</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word\tsh_name;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section name (string tbl index) */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word\tsh_type;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section type */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Xword\tsh_flags;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section flags */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Addr\tsh_addr;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section virtual addr at execution */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Off\tsh_offset;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section file offset */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Xword\tsh_size;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section size in bytes */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word\tsh_link;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Link to another section */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word\tsh_info;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Additional section information */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Xword\tsh_addralign;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section alignment */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Xword\tsh_entsize;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Entry size if section holds table */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} Elf64_Shdr;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/image/chapter02/Elf64_Shdr结构含义.png" alt="Elf64_Shdr" loading="lazy"><br> 段表结构解析<br><img src="/image/chapter02/段结构分析.png" alt="段结构解析" loading="lazy"></p><div class="hint-container note"><p class="hint-container-title">注</p><p>elf文件头中指出了段表位于文件的偏移(Elf64_Ehdr的e_shoff元素)为1032(0x408)，代码段(.text)位于elf文件头后所以elf文件头的大小正好为代码段的偏移0x40(64)字节，段表的最后一个元素(.shstrtab)的偏移量为0x390文件大小为0x74。而0x408 = 0x390 + 0x74 + 0x04正好是段表在elf文件中的偏移(之所以+0x04是因为内存对齐的原因)。</p></div><h5 id="_4-2-1-1-段的类型-sh-type" tabindex="-1"><a class="header-anchor" href="#_4-2-1-1-段的类型-sh-type"><span>4.2.1.1 段的类型(sh_type)</span></a></h5><div class="hint-container tip"><p class="hint-container-title">提示</p><p>对于编译器和链接器来说，主要决定段的属性的是段的类型(sh_type)和段的标志位(sh_flags)</p></div><figure><img src="/image/chapter02/段的类型.png" alt="段的类型" tabindex="0" loading="lazy"><figcaption>段的类型</figcaption></figure><h5 id="_4-2-1-2-段的标志位-sh-flags" tabindex="-1"><a class="header-anchor" href="#_4-2-1-2-段的标志位-sh-flags"><span>4.2.1.2 段的标志位(sh_flags)</span></a></h5><div class="hint-container tip"><p class="hint-container-title">提示</p><p>决定了该段在进程虚拟地址空间中的属性，比如是否可写，是否可执行等。</p></div><figure><img src="/image/chapter02/段的标志位.png" alt="段的标志位" tabindex="0" loading="lazy"><figcaption>段的标志位</figcaption></figure><h5 id="_4-2-1-3-段的链接信息-sh-link、sh-info" tabindex="-1"><a class="header-anchor" href="#_4-2-1-3-段的链接信息-sh-link、sh-info"><span>4.2.1.3 段的链接信息(sh_link、sh_info)</span></a></h5><div class="hint-container tip"><p class="hint-container-title">提示</p><p>只有段的类型是与链接(动态链接、静态链接、重定位表、符号表等)相关时这两个成员才会有意义。</p></div><figure><img src="/image/chapter02/段的链接信息.png" alt="段的链接信息" tabindex="0" loading="lazy"><figcaption>段的链接信息</figcaption></figure><h3 id="_4-3-重定位表" tabindex="-1"><a class="header-anchor" href="#_4-3-重定位表"><span>4.3 重定位表</span></a></h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>在SimpleSection.o中有一个叫做&quot;.rela.text&quot;的段, 它的类型(sh_type)为&quot;SH_RELA&quot;, 也就是说它是一个重定位表。<br> 对于每个需要重定位的段，都会有一个相应的重定位表。比如&quot;.rela.text&quot;是&quot;.text&quot;的重定位表。<br> 一个重定位表同时也是elf的一个段, 那么这个段的类型(sh_type)就是&quot;SHL_REL&quot;, 它的&quot;sh_link&quot;表示符号表的下标, &quot;sh_info&quot;表示它作用于那个段。</p></div><figure><img src="/image/chapter02/重定位表.png" alt="重定位表" tabindex="0" loading="lazy"><figcaption>重定位表</figcaption></figure><h3 id="_4-4-字符串表" tabindex="-1"><a class="header-anchor" href="#_4-4-字符串表"><span>4.4 字符串表</span></a></h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>elf文件中用到了很多字符串，比如段名、变量名等。因为字符串的长度往往是不定的，所以用固定的结构来表示它比较困难。一种常见的做法是把字符串集中起来存放到一个表，然后使用字符串在表中的偏移来引用字符串。<br> .strtab: 字符串表(string table)<br> .shstrtab: 段表字符串表(section header string table)</p></div><p><img src="/image/chapter02/字符串表.png" alt="字符串表" loading="lazy"><br><img src="/image/chapter02/段表字符串表分析.png" alt="段表字符串表" loading="lazy"></p><h2 id="_5-链接的接口-符号-symbol" tabindex="-1"><a class="header-anchor" href="#_5-链接的接口-符号-symbol"><span>5. 链接的接口-符号(Symbol)</span></a></h2><div class="hint-container tip"><p class="hint-container-title">提示</p><p>链接的过程就是把多个不同的目标文件之间相互衔接的过程。这个相互衔接的过程实际上是目标文件之间对地址的引用。<br> 比如文件B用到了目标A中的函数&quot;foo&quot;, 那么我们就称文件A<code>定义(define)</code>了函数&quot;foo&quot;, 称目标文件B<code>引用(refrence)</code>了目标文件A中的函数&quot;foo&quot;。这两个概念同样适用于变量。<br> 在链接中将函数和变量称为<code>符号(Symbol)</code>, 函数名和变量名称为<code>符号名(Symbol Name)</code><br><code>符号是链接中的粘合剂</code>, 整个链接的过程基于符号才能正确完成。<br> 每一个目标文件都有一个相应的<code>符号表(Symbol Table)</code>对符号进行管理, 该表记录了目标文件中所用的所有符号。每个定义的符号都有一个对应的值, 叫做<code>符号值(Symbol Value)</code>, 对于<code>变量和函数</code>来说, 符号值就是它们的<code>地址</code>。除了函数和变量外，还存在其它几种不常用的符号。</p></div><ul><li>定义在目标文件的全局符号，可以被其它目标文件引用</li><li>在本文件中引用的全局符号，却没有在本文件中定义，一般叫做<code>外部符号(External Symbol)</code>，也被称为符号引用</li><li>段名，由编译器生成，它的值就是该段的起始地址。(.text, .data)</li><li>局部符号，只在编译器内部可见。(SimpleSection.o文件的static_var和static_var2)</li><li>行号信息，即目标文件指令与源代码中代码行的对应关系，可选。</li></ul><p>使用nm指令查看符号结果</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">nm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> T</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> func1</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> D</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_init_var</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000004</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> C</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_uninit_var</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">000000000000002b</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> T</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                 U</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> printf</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000004</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var.1</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> b</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var2.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-1-elf符号表结构" tabindex="-1"><a class="header-anchor" href="#_5-1-elf符号表结构"><span>5.1 ELF符号表结构</span></a></h3><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// /usr/include/elf.h</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word\tst_name;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Symbol name (string tbl index) */</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">\tst_info;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Symbol type and binding */</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> st_other;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Symbol visibility */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Section\tst_shndx;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Section index */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Addr\tst_value;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Symbol value */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Xword\tst_size;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">\t\t/* Symbol size */</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} Elf64_Sym;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/image/chapter02/ELF符号表结构.png" alt="ELF符号表结构" tabindex="0" loading="lazy"><figcaption>ELF符号表结构</figcaption></figure><h4 id="_5-1-1-符号类型和绑定类型-st-info" tabindex="-1"><a class="header-anchor" href="#_5-1-1-符号类型和绑定类型-st-info"><span>5.1.1 符号类型和绑定类型(st_info)</span></a></h4><div class="hint-container tip"><p class="hint-container-title">提示</p><p>低4位表示<code>符号类型(Symbol Type)</code>, 高28位表示<code>符号绑定信息(Symbol Binding)</code></p></div><figure><img src="/image/chapter02/符号类型和绑定.png" alt="符号类型和绑定" tabindex="0" loading="lazy"><figcaption>符号类型和绑定</figcaption></figure><h4 id="_5-1-2-符号所在段-st-shndx" tabindex="-1"><a class="header-anchor" href="#_5-1-2-符号所在段-st-shndx"><span>5.1.2 符号所在段(st_shndx)</span></a></h4><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果符号定义在本目标文件中，那么这个成员表示符号所在的段在段表中的下标，如果符号不是定义在本目标文件中，或者对于有些特殊符号，sh_shndx的值会有些特殊。</p></div><figure><img src="/image/chapter02/符号所在段.png" alt="符号所在段" tabindex="0" loading="lazy"><figcaption>符号所在段</figcaption></figure><h4 id="_5-1-3-符号值-st-value" tabindex="-1"><a class="header-anchor" href="#_5-1-3-符号值-st-value"><span>5.1.3 符号值(st_value)</span></a></h4><div class="hint-container tip"><p class="hint-container-title">提示</p><p>每个符号都有一个对应的值，如果这个符号是一个函数或变量的定义，那么符号的值就是这个函数或变量的地址。</p></div><ul><li>在目标文件中，如果是符号的定义并且该符号不是<code>&quot;COMMON块&quot;类型</code>的，则st_value表示<code>该符号在段中的偏移。</code>比如SimpleSection.o中的&quot;func1&quot;、&quot;main&quot;、&quot;global_init_var&quot;。</li><li>在目标文件中，如果符号是&quot;COMMON块&quot;，st_value表示该符号的对齐属性。比如SimpleSection.o中的&quot;global_uninit_var&quot;。</li><li>在可执行文件中，st_value表示符号的虚拟地址。<br> 使用readelf -s查看符号表</li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 注意编译时使用了-fcommon编译选项</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">readelf</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Symbol</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;.symtab&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> contains</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 13</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> entries:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   Num:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Value</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          Size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Bind</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   Vis</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      Ndx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Name</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     0:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NOTYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  UND</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     1:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FILE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ABS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.c</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     2:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .text</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     3:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .data</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     4:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .bss</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     5:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .rodata</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     6:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var.1</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     7:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var2.0</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     8:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_init_var</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     9:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  COM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_uninit_var</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    10:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    43</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FUNC</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> func1</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    11:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NOTYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  UND</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> printf</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    12:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 000000000000002b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    57</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FUNC</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-2-特殊符号" tabindex="-1"><a class="header-anchor" href="#_5-2-特殊符号"><span>5.2 特殊符号</span></a></h3>',93)],l={},k=(0,a(6262).A)(l,[["render",function(i,s){return(0,n.uX)(),(0,n.CE)("div",null,h)}]]),t=JSON.parse('{"path":"/cs/linker/chapter02.html","title":"第二章 目标文件","lang":"zh-CN","frontmatter":{"title":"第二章 目标文件","date":"2024-06-22T23:52:32.000Z","tags":["计算机基础","c/c++"],"categories":"链接、装载与库","description":"1. 目标文件的格式 Linux下的主流文件存储格式为ELF，通过file指令可以查看文件的存储格式。 ELF文件标准里采用ELF格式的文件: 可重定位文件 Linux的 *.o文件 静态链接库 可执行文件 共享目标文件 Linux的 *.so文件 核心转储文件 Linux下的 core dump 2. 目标文件是什么样的 目标文件将信息按不同的属性进...","head":[["meta",{"property":"og:url","content":"https://hncat.github.io/cs/linker/chapter02.html"}],["meta",{"property":"og:site_name","content":"far"}],["meta",{"property":"og:title","content":"第二章 目标文件"}],["meta",{"property":"og:description","content":"1. 目标文件的格式 Linux下的主流文件存储格式为ELF，通过file指令可以查看文件的存储格式。 ELF文件标准里采用ELF格式的文件: 可重定位文件 Linux的 *.o文件 静态链接库 可执行文件 共享目标文件 Linux的 *.so文件 核心转储文件 Linux下的 core dump 2. 目标文件是什么样的 目标文件将信息按不同的属性进..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://hncat.github.io/image/chapter02/程序与目标文件.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-06-27T15:11:12.000Z"}],["meta",{"property":"article:author","content":"Mr.far"}],["meta",{"property":"article:tag","content":"计算机基础"}],["meta",{"property":"article:tag","content":"c/c++"}],["meta",{"property":"article:published_time","content":"2024-06-22T23:52:32.000Z"}],["meta",{"property":"article:modified_time","content":"2024-06-27T15:11:12.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"第二章 目标文件\\",\\"image\\":[\\"https://hncat.github.io/image/chapter02/程序与目标文件.png\\",\\"https://hncat.github.io/image/chapter02/其他段.png\\",\\"https://hncat.github.io/image/chapter02/ELF文件结构.png\\",\\"https://hncat.github.io/image/chapter02/ELF文件头结构成员含义.png\\",\\"https://hncat.github.io/image/chapter02/文件类型.png\\",\\"https://hncat.github.io/image/chapter02/机器类型.png\\",\\"https://hncat.github.io/image/chapter02/Elf64_Shdr结构含义.png\\",\\"https://hncat.github.io/image/chapter02/段结构分析.png\\",\\"https://hncat.github.io/image/chapter02/段的类型.png\\",\\"https://hncat.github.io/image/chapter02/段的标志位.png\\",\\"https://hncat.github.io/image/chapter02/段的链接信息.png\\",\\"https://hncat.github.io/image/chapter02/重定位表.png\\",\\"https://hncat.github.io/image/chapter02/字符串表.png\\",\\"https://hncat.github.io/image/chapter02/段表字符串表分析.png\\",\\"https://hncat.github.io/image/chapter02/ELF符号表结构.png\\",\\"https://hncat.github.io/image/chapter02/符号类型和绑定.png\\",\\"https://hncat.github.io/image/chapter02/符号所在段.png\\"],\\"datePublished\\":\\"2024-06-22T23:52:32.000Z\\",\\"dateModified\\":\\"2024-06-27T15:11:12.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.far\\",\\"url\\":\\"https://hncat.github.io\\"}]}"]]},"headers":[{"level":2,"title":"1. 目标文件的格式","slug":"_1-目标文件的格式","link":"#_1-目标文件的格式","children":[]},{"level":2,"title":"2. 目标文件是什么样的","slug":"_2-目标文件是什么样的","link":"#_2-目标文件是什么样的","children":[]},{"level":2,"title":"3. 挖掘SimpleSection.o","slug":"_3-挖掘simplesection-o","link":"#_3-挖掘simplesection-o","children":[{"level":3,"title":"3.1 代码段","slug":"_3-1-代码段","link":"#_3-1-代码段","children":[]},{"level":3,"title":"3.2 数据段和只读数据段","slug":"_3-2-数据段和只读数据段","link":"#_3-2-数据段和只读数据段","children":[]},{"level":3,"title":"3.3 bss段","slug":"_3-3-bss段","link":"#_3-3-bss段","children":[]},{"level":3,"title":"3.3 其它段","slug":"_3-3-其它段","link":"#_3-3-其它段","children":[]}]},{"level":2,"title":"4. ELF文件结构描述","slug":"_4-elf文件结构描述","link":"#_4-elf文件结构描述","children":[{"level":3,"title":"4.1 文件头","slug":"_4-1-文件头","link":"#_4-1-文件头","children":[]},{"level":3,"title":"4.2 段表","slug":"_4-2-段表","link":"#_4-2-段表","children":[]},{"level":3,"title":"4.3 重定位表","slug":"_4-3-重定位表","link":"#_4-3-重定位表","children":[]},{"level":3,"title":"4.4 字符串表","slug":"_4-4-字符串表","link":"#_4-4-字符串表","children":[]}]},{"level":2,"title":"5. 链接的接口-符号(Symbol)","slug":"_5-链接的接口-符号-symbol","link":"#_5-链接的接口-符号-symbol","children":[{"level":3,"title":"5.1 ELF符号表结构","slug":"_5-1-elf符号表结构","link":"#_5-1-elf符号表结构","children":[]},{"level":3,"title":"5.2 特殊符号","slug":"_5-2-特殊符号","link":"#_5-2-特殊符号","children":[]}]}],"git":{"createdTime":1719501072000,"updatedTime":1719501072000,"contributors":[{"name":"far","email":"v19991123v@163.com","commits":1}]},"readingTime":{"minutes":14.07,"words":4222},"filePathRelative":"cs/linker/chapter02.md","localizedDate":"2024年6月22日","excerpt":"<h2>1. 目标文件的格式</h2>\\n<p>Linux下的主流文件存储格式为<mark>ELF</mark>，通过file指令可以查看文件的存储格式。</p>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" data-title=\\"bash\\" style=\\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes github-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">$</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">&gt; </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">file</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> foobar.o</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">foobar.o:</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> ELF</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> 64-bit</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> LSB</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> relocatable,</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> x86-64,</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> version</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\"> 1</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> (SYSV), not stripped</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">$</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">&gt; </span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">file</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> /bin/bash</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">/bin/bash:</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> ELF</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> 64-bit</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> LSB</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> pie</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> executable,</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> x86-64,</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> version</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\"> 1</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, </span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">BuildID</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">[</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">sha1</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">]</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">2f77b36371c214e11670c7d9d92727e9a49f626b,</span><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\"> for</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> GNU/Linux</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> 3.2.0,</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> stripped</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">file</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> /lib32/ld-linux.so.2</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\">/lib32/ld-linux.so.2:</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> ELF</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> 32-bit</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> LSB</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> shared</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> object,</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> Intel</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> 80386,</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\"> version</span><span style=\\"--shiki-light:#005CC5;--shiki-dark:#D19A66\\"> 1</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\"> (GNU/Linux), static-pie linked, </span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">BuildID</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">[</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#E06C75\\">sha1</span><span style=\\"--shiki-light:#24292E;--shiki-dark:#ABB2BF\\">]</span><span style=\\"--shiki-light:#D73A49;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#032F62;--shiki-dark:#98C379\\">595f7870a8165b3eb04c9ebda08a8ccba6f742c2,</span><span style=\\"--shiki-light:#6F42C1;--shiki-dark:#61AFEF\\"> stripped</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}')}}]);