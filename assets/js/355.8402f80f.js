"use strict";(self.webpackChunkfar_blog=self.webpackChunkfar_blog||[]).push([[355],{7355:(e,a,t)=>{t.r(a),t.d(a,{default:()=>m});var s=t(3812),l=t(3073),r=t(9271),i=t(953),u=t(641),c=t(8278),n=t(6883),h=t(656);const o=["/","/intro.html","/code/","/cs/","/database/","/cs/linker/","/cs/linker/chapter01.html","/cs/linker/chapter02.html","/cs/linker/chapter03.html","/cs/linker/chapter04.html","/cs/linker/chapter05.html","/database/basic/","/database/basic/chapter01.html","/database/basic/chapter02.html","/database/basic/chapter03.html","/database/basic/chapter04.html","/database/basic/chapter05.html","/database/basic/chapter06.html","/database/basic/chapter07.html","/database/basic/chapter08.html","/database/basic/chapter09.html","/database/basic/chapter10.html","/database/basic/chapter11.html","/database/basic/chapter12.html","/database/basic/chapter13.html","/database/basic/chapter14.html","/database/basic/chapter15.html","/404.html","/category/","/category/cc__/","/category/%E9%93%BE%E6%8E%A5%E3%80%81%E8%A3%85%E8%BD%BD%E4%B8%8E%E5%BA%93/","/category/mysql/","/tag/","/tag/cc__/","/tag/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/","/tag/%E6%95%B0%E6%8D%AE%E5%BA%93/","/article/","/star/","/timeline/"];t(6039);const v=(0,l.Mjh)("SEARCH_PRO_QUERY_HISTORY",[]),p=e=>o[e.id]+("anchor"in e?`#${e.anchor}`:""),{resultHistoryCount:d}=h.s,y=(0,l.Mjh)("SEARCH_PRO_RESULT_HISTORY",[]);var m=(0,u.pM)({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(e,{emit:a}){const t=(0,c.rd)(),o=(0,c.Zv)(),m=(0,s.s5)(h.a),{enabled:b,addQueryHistory:g,queryHistory:E,removeQueryHistory:k}=(()=>{const{queryHistoryCount:e}=h.s,a=e>0;return{enabled:a,queryHistory:v,addQueryHistory:t=>{a&&(v.value=Array.from(new Set([t,...v.value.slice(0,e-1)])))},removeQueryHistory:e=>{v.value=[...v.value.slice(0,e),...v.value.slice(e+1)]}}})(),{enabled:H,resultHistory:f,addResultHistory:A,removeResultHistory:Q}=(()=>{const e=d>0;return{enabled:e,resultHistory:y,addResultHistory:a=>{if(e){const e={link:p(a),display:a.display};"header"in a&&(e.header=a.header),y.value=[e,...y.value.slice(0,d-1)]}},removeResultHistory:e=>{y.value=[...y.value.slice(0,e),...y.value.slice(e+1)]}}})(),R=b||H,w=(0,i.lW)(e,"queries"),{results:C,isSearching:q}=(e=>{const a=(0,h.u)(),t=(0,c.Zv)(),s=(0,c.BV)(),l=(0,i.KR)(0),n=(0,u.EW)((()=>l.value>0)),o=(0,i.IJ)([]);return(0,u.sV)((()=>{const{search:i,terminate:c}=(0,h.c)(),n=(0,r.Q0)((e=>{const r=e.join(" "),{searchFilter:u=(e=>e),splitWord:c,suggestionsFilter:n,...h}=a.value;r?(l.value+=1,i(e.join(" "),t.value,h).then((e=>u(e,r,t.value,s.value))).then((e=>{l.value-=1,o.value=e})).catch((e=>{console.warn(e),l.value-=1,l.value||(o.value=[])}))):o.value=[]}),h.s.searchDelay-h.s.suggestDelay);(0,u.wB)([e,t],(([e])=>n(e)),{immediate:!0}),(0,u.hi)((()=>{c()}))})),{isSearching:n,results:o}})(w),x=(0,i.Kh)({isQuery:!0,index:0}),B=(0,i.KR)(0),_=(0,i.KR)(0),S=(0,u.EW)((()=>R&&(E.value.length>0||f.value.length>0))),D=(0,u.EW)((()=>C.value.length>0)),W=(0,u.EW)((()=>C.value[B.value]||null)),T=e=>e.map((e=>(0,s.Kg)(e)?e:(0,u.h)(e[0],e[1]))),j=e=>{if("customField"===e.type){const a=h.b[e.index]||"$content",[t,l=""]=(0,s.Qd)(a)?a[o.value].split("$content"):a.split("$content");return e.display.map((e=>(0,u.h)("div",T([t,...e,l]))))}return e.display.map((e=>(0,u.h)("div",T(e))))},F=()=>{B.value=0,_.value=0,a("updateQuery",""),a("close")};return(0,l.MLh)("keydown",(s=>{if(e.isFocusing)if(D.value){if("ArrowUp"===s.key)_.value>0?_.value-=1:(B.value=B.value>0?B.value-1:C.value.length-1,_.value=W.value.contents.length-1);else if("ArrowDown"===s.key)_.value<W.value.contents.length-1?_.value+=1:(B.value=B.value<C.value.length-1?B.value+1:0,_.value=0);else if("Enter"===s.key){const a=W.value.contents[_.value];g(e.queries.join(" ")),A(a),t.push(p(a)),F()}}else if(H)if("ArrowUp"===s.key)(()=>{const{isQuery:e,index:a}=x;0===a?(x.isQuery=!e,x.index=e?f.value.length-1:E.value.length-1):x.index=a-1})();else if("ArrowDown"===s.key)(()=>{const{isQuery:e,index:a}=x;a===(e?E.value.length-1:f.value.length-1)?(x.isQuery=!e,x.index=0):x.index=a+1})();else if("Enter"===s.key){const{index:e}=x;x.isQuery?(a("updateQuery",E.value[e]),s.preventDefault()):(t.push(f.value[e].link),F())}})),(0,u.wB)([B,_],(()=>{document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active")?.scrollIntoView(!1)}),{flush:"post"}),()=>(0,u.h)("div",{class:["search-pro-result-wrapper",{empty:e.queries.length?!D.value:!S.value}],id:"search-pro-results"},e.queries.length?q.value?(0,u.h)(n.S,{hint:m.value.searching}):D.value?(0,u.h)("ul",{class:"search-pro-result-list"},C.value.map((({title:a,contents:t},s)=>{const l=B.value===s;return(0,u.h)("li",{class:["search-pro-result-list-item",{active:l}]},[(0,u.h)("div",{class:"search-pro-result-title"},a||m.value.defaultTitle),t.map(((a,t)=>{const s=l&&_.value===t;return(0,u.h)(c.Wt,{to:p(a),class:["search-pro-result-item",{active:s,"aria-selected":s}],onClick:()=>{g(e.queries.join(" ")),A(a),F()}},(()=>["text"===a.type?null:(0,u.h)("title"===a.type?n.T:"heading"===a.type?n.H:n.a,{class:"search-pro-result-type"}),(0,u.h)("div",{class:"search-pro-result-content"},["text"===a.type&&a.header?(0,u.h)("div",{class:"content-header"},a.header):null,(0,u.h)("div",j(a))])]))}))])}))):m.value.emptyResult:R?S.value?[b?(0,u.h)("ul",{class:"search-pro-result-list"},(0,u.h)("li",{class:"search-pro-result-list-item"},[(0,u.h)("div",{class:"search-pro-result-title"},m.value.queryHistory),E.value.map(((e,t)=>(0,u.h)("div",{class:["search-pro-result-item",{active:x.isQuery&&x.index===t}],onClick:()=>{a("updateQuery",e)}},[(0,u.h)(n.b,{class:"search-pro-result-type"}),(0,u.h)("div",{class:"search-pro-result-content"},e),(0,u.h)("button",{class:"search-pro-remove-icon",innerHTML:n.C,onClick:e=>{e.preventDefault(),e.stopPropagation(),k(t)}})])))])):null,H?(0,u.h)("ul",{class:"search-pro-result-list"},(0,u.h)("li",{class:"search-pro-result-list-item"},[(0,u.h)("div",{class:"search-pro-result-title"},m.value.resultHistory),f.value.map(((e,a)=>(0,u.h)(c.Wt,{to:e.link,class:["search-pro-result-item",{active:!x.isQuery&&x.index===a}],onClick:()=>{F()}},(()=>[(0,u.h)(n.b,{class:"search-pro-result-type"}),(0,u.h)("div",{class:"search-pro-result-content"},[e.header?(0,u.h)("div",{class:"content-header"},e.header):null,(0,u.h)("div",e.display.map((e=>T(e))).flat())]),(0,u.h)("button",{class:"search-pro-remove-icon",innerHTML:n.C,onClick:e=>{e.preventDefault(),e.stopPropagation(),Q(a)}})]))))])):null]:m.value.emptyHistory:m.value.emptyResult)}})}}]);