<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.50" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://hncat.github.io/cs/linker/chapter02.html"><meta property="og:site_name" content="far"><meta property="og:title" content="第二章 目标文件"><meta property="og:description" content="1. 目标文件的格式 Linux下的主流文件存储格式为ELF，通过file指令可以查看文件的存储格式。 ELF文件标准里采用ELF格式的文件: 可重定位文件 Linux的 *.o文件 静态链接库 可执行文件 共享目标文件 Linux的 *.so文件 核心转储文件 Linux下的 core dump 2. 目标文件是什么样的 目标文件将信息按不同的属性进..."><meta property="og:type" content="article"><meta property="og:image" content="https://hncat.github.io/image/linker/chapter02/程序与目标文件.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-07-10T00:54:45.000Z"><meta property="article:author" content="Mr.far"><meta property="article:tag" content="计算机基础"><meta property="article:tag" content="c/c++"><meta property="article:published_time" content="2024-06-22T00:00:00.000Z"><meta property="article:modified_time" content="2024-07-10T00:54:45.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"第二章 目标文件","image":["https://hncat.github.io/image/linker/chapter02/程序与目标文件.png","https://hncat.github.io/image/linker/chapter02/其他段.png","https://hncat.github.io/image/linker/chapter02/ELF文件结构.png","https://hncat.github.io/image/linker/chapter02/ELF文件头结构成员含义.png","https://hncat.github.io/image/linker/chapter02/文件类型.png","https://hncat.github.io/image/linker/chapter02/机器类型.png","https://hncat.github.io/image/linker/chapter02/Elf64_Shdr结构含义.png","https://hncat.github.io/image/linker/chapter02/段结构分析.png","https://hncat.github.io/image/linker/chapter02/段的类型.png","https://hncat.github.io/image/linker/chapter02/段的标志位.png","https://hncat.github.io/image/linker/chapter02/段的链接信息.png","https://hncat.github.io/image/linker/chapter02/重定位表.png","https://hncat.github.io/image/linker/chapter02/字符串表.png","https://hncat.github.io/image/linker/chapter02/段表字符串表分析.png","https://hncat.github.io/image/linker/chapter02/ELF符号表结构.png","https://hncat.github.io/image/linker/chapter02/符号类型和绑定.png","https://hncat.github.io/image/linker/chapter02/符号所在段.png","https://hncat.github.io/image/linker/chapter02/c++名称修饰.png"],"datePublished":"2024-06-22T00:00:00.000Z","dateModified":"2024-07-10T00:54:45.000Z","author":[{"@type":"Person","name":"Mr.far","url":"https://hncat.github.io"}]}</script><link rel="icon" href="/far-logo.png"><title>第二章 目标文件 | far</title><meta name="description" content="1. 目标文件的格式 Linux下的主流文件存储格式为ELF，通过file指令可以查看文件的存储格式。 ELF文件标准里采用ELF格式的文件: 可重定位文件 Linux的 *.o文件 静态链接库 可执行文件 共享目标文件 Linux的 *.so文件 核心转储文件 Linux下的 core dump 2. 目标文件是什么样的 目标文件将信息按不同的属性进...">
    <link rel="stylesheet" href="/assets/css/styles.474b4e58.css">
    <link rel="preload" href="/assets/js/runtime~app.efa7a504.js" as="script"><link rel="preload" href="/assets/css/styles.474b4e58.css" as="style"><link rel="preload" href="/assets/js/783.700e2d1b.js" as="script"><link rel="preload" href="/assets/js/app.85ac5ea2.js" as="script">
    <link rel="prefetch" href="/assets/js/cs_linker_chapter05.html.77c04323.js" as="script"><link rel="prefetch" href="/assets/js/cs_linker_chapter02.html.bf55fc35.js" as="script"><link rel="prefetch" href="/assets/js/cs_linker_chapter03.html.7b0620ca.js" as="script"><link rel="prefetch" href="/assets/js/cs_linker_chapter04.html.9a684e8f.js" as="script"><link rel="prefetch" href="/assets/js/photo-swipe.9d042e79.js" as="script"><link rel="prefetch" href="/assets/js/cs_linker_chapter01.html.7c52f0d5.js" as="script"><link rel="prefetch" href="/assets/js/355.1758851b.js" as="script"><link rel="prefetch" href="/assets/css/796.styles.b6833da5.css" as="style"><link rel="prefetch" href="/assets/js/intro.html.5d8e7132.js" as="script"><link rel="prefetch" href="/assets/js/cs_linker_index.html.07125d7f.js" as="script"><link rel="prefetch" href="/assets/js/code_index.html.2116ccd1.js" as="script"><link rel="prefetch" href="/assets/js/index.html.237e5c31.js" as="script"><link rel="prefetch" href="/assets/js/cs_index.html.aa694759.js" as="script"><link rel="prefetch" href="/assets/js/category_链接、装载与库_index.html.d23d7e1b.js" as="script"><link rel="prefetch" href="/assets/js/tag_计算机基础_index.html.559b3da4.js" as="script"><link rel="prefetch" href="/assets/js/category_cc___index.html.cb4616a8.js" as="script"><link rel="prefetch" href="/assets/js/tag_cc___index.html.190f77a9.js" as="script"><link rel="prefetch" href="/assets/js/404.html.133c9374.js" as="script"><link rel="prefetch" href="/assets/js/timeline_index.html.f12b8111.js" as="script"><link rel="prefetch" href="/assets/js/category_index.html.daa79026.js" as="script"><link rel="prefetch" href="/assets/js/article_index.html.9020c812.js" as="script"><link rel="prefetch" href="/assets/js/tag_index.html.c3e94483.js" as="script"><link rel="prefetch" href="/assets/js/star_index.html.41917632.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/far-logo.png" alt><!----><span class="vp-site-name hide-in-pad">far</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="博客主页"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->博客主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/cs/" aria-label="计算机基础"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->计算机基础<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/code/" aria-label="c/c++"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-code" style=""></span><!--]-->c/c++<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/hncat" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/" aria-label="博客主页"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->博客主页<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><span class="font-icon icon fa-fw fa-sm fas fa-code" style=""></span><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/code/" aria-label="c/c++"><!---->c/c++<!----></a><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/cs/" aria-label="计算机基础"><!---->计算机基础<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/cs/linker/" aria-label="链接、装载和库"><!---->链接、装载和库<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/cs/linker/chapter01.html" aria-label="第一章 编译和链接"><!---->第一章 编译和链接<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/cs/linker/chapter02.html" aria-label="第二章 目标文件"><!---->第二章 目标文件<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/cs/linker/chapter03.html" aria-label="第三章 静态链接"><!---->第三章 静态链接<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/cs/linker/chapter04.html" aria-label="第四章 可执行文件的装载"><!---->第四章 可执行文件的装载<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/cs/linker/chapter05.html" aria-label="第五章 动态链接"><!---->第五章 动态链接<!----></a></li></ul></section></li></ul></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/intro.html" aria-label="介绍页"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span><!--]-->介绍页<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->第二章 目标文件</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://hncat.github.io" target="_blank" rel="noopener noreferrer">Mr.far</a></span><span property="author" content="Mr.far"></span></span><span class="page-original-info">原创</span><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-22T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 20 分钟</span><meta property="timeRequired" content="PT20M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color7 clickable" role="navigation">链接、装载与库</span><!--]--><meta property="articleSection" content="链接、装载与库"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color7 clickable" role="navigation">计算机基础</span><span class="page-tag-item color4 clickable" role="navigation">c/c++</span><!--]--><meta property="keywords" content="计算机基础,c/c++"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-目标文件的格式">1. 目标文件的格式</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-目标文件是什么样的">2. 目标文件是什么样的</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-挖掘simplesection-o">3. 挖掘SimpleSection.o</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-1-代码段">3.1 代码段</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-2-数据段和只读数据段">3.2 数据段和只读数据段</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-3-bss段">3.3 bss段</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-3-其它段">3.3 其它段</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-elf文件结构描述">4. ELF文件结构描述</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-1-文件头">4.1 文件头</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-2-段表">4.2 段表</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-3-重定位表">4.3 重定位表</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-4-字符串表">4.4 字符串表</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-链接的接口-符号-symbol">5. 链接的接口-符号(Symbol)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-1-elf符号表结构">5.1 ELF符号表结构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-2-特殊符号">5.2 特殊符号</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-4-extern-c">5.4 extern &quot;C&quot;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-5-强符合与弱符号">5.5 强符合与弱符号</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-6-调试信息">5.6 调试信息</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h2 id="_1-目标文件的格式" tabindex="-1"><a class="header-anchor" href="#_1-目标文件的格式"><span>1. 目标文件的格式</span></a></h2><p>Linux下的主流文件存储格式为<mark>ELF</mark>，通过file指令可以查看文件的存储格式。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> foobar.o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">foobar.o:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ELF</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 64-bit</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LSB</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> relocatable,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> x86-64,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (SYSV), not stripped</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /bin/bash</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/bin/bash:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ELF</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 64-bit</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LSB</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pie</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> executable,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> x86-64,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">BuildID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sha1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2f77b36371c214e11670c7d9d92727e9a49f626b,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GNU/Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 3.2.0,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> stripped</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /lib32/ld-linux.so.2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/lib32/ld-linux.so.2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ELF</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 32-bit</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LSB</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shared</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> object,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Intel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 80386,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (GNU/Linux), static-pie linked, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">BuildID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sha1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">595f7870a8165b3eb04c9ebda08a8ccba6f742c2,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> stripped</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ELF文件标准里采用ELF格式的文件:</p><ul><li>可重定位文件<br> Linux的 *.o文件<br> 静态链接库</li><li>可执行文件</li><li>共享目标文件<br> Linux的 *.so文件</li><li>核心转储文件<br> Linux下的 core dump</li></ul><h2 id="_2-目标文件是什么样的" tabindex="-1"><a class="header-anchor" href="#_2-目标文件是什么样的"><span>2. 目标文件是什么样的</span></a></h2><p>目标文件将信息按不同的属性进行存储，通常称之为<mark>节(section)或者段(segment)</mark></p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>源代码编译后的机器指令经常放于代码段(.text)<br> 全局变量和局部静态变量经常存放于数据段(.data)</p></div><p><img src="/image/linker/chapter02/程序与目标文件.png" alt="程序与目标文件" loading="lazy"><br> ELF文件的开头是一个“文件头”，描述了整个文件的文件属性。</p><ul><li>是否可执行</li><li>是否静态链接</li><li>是否动态链接</li><li>入口地址</li><li>目标硬件</li><li>目标操作系统</li><li>等等</li></ul><p>文件头同时包括一个段表</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>段表用来描述一个文件中各个段的数组。段表描述了文件中各个段在文件中的偏移位置及段的属性等，从段表中可以得到每个的段的所有信息。<br> .data section: 已初始化的全局变量和局部静态变量<br> .bss section: 未初始化的全局变量和局部静态变量(默认值为0),初始化为0的全局变量和局部静态变量<br> .bss段只是为未初始化的全局变量和局部静态变量预留位置而已(记录所有为初始或者初始化为0的全局变量和静态变量的大小总和)，所以在文件中也不占据空间</p></div><p>分段的好处</p><ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-0" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-0"> 可以防止程序被恶意篡改</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-1" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-1"> 利用缓存，提高CPU的缓存命中</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-2" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-2"> 节省内存空间(内存共享比如libc的动态链接库)</label></li></ul><h2 id="_3-挖掘simplesection-o" tabindex="-1"><a class="header-anchor" href="#_3-挖掘simplesection-o"><span>3. 挖掘SimpleSection.o</span></a></h2><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> printf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> global_init_var </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 84</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> global_uninit_var;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> func1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> i</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">printf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, i); }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  static</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> static_var </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 85</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  static</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> static_var2;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> b;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  func1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(static_var </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> static_var2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> b);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>使用objdump -h指令打印ELF文件的各个段的基本信息<br> -x 参数可以打印更多信息</p></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">objdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SimpleSection.o:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> elf64-x86-64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Sections:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Idx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          Size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      VMA</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">               LMA</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">               File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> off</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Algn</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .text</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         00000064</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000040</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ALLOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOAD,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RELOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> CODE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .data</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         00000008</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000a4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ALLOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOAD,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DATA</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .bss</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">          00000008</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000ac</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  ALLOC</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .rodata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       00000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000ac</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ALLOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOAD,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DATA</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .comment</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      00000027</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000b0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .note.GNU-stack</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000d7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  6</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .note.gnu.property</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000020</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000d8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ALLOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOAD,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DATA</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .eh_frame</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     00000058</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000f8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">**</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                  CONTENTS,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ALLOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOAD,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RELOC,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> READONLY,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DATA</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">注</p><p>.rodata: 只读数据段<br> .comment: 注释信息段<br> .note.GNU-stack: 堆栈提示段<br> Size: 段的长度<br> File Offset: 段所在的位置(段偏移)<br> CONTENTS: 该段在文件中存在(bss段没有表示bss段在ELF文件中不存在内容。.note.GNU-stack虽然有但是长度为0，认为它在ELF文件中也不存在)</p></div><p>使用<mark>size</mark>指令查看ELF文件的代码段、数据段和bss段。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   text</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    data</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     bss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     dec</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> filename</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    224</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     240</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      f0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-1-代码段" tabindex="-1"><a class="header-anchor" href="#_3-1-代码段"><span>3.1 代码段</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">objdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SimpleSection.o:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> elf64-x86-64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .text:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> f30f1efa</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 554889e5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4883ec10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 897dfc8b</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ....UH..H....}..</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0010</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 45fc89c6</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 488d0500</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000048</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 89c7b800</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  E...H......H....</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0020</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 000000e8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 90c9c3f3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f1efa55</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ...............U</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0030</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4889e548</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 83ec10c7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 45f80100</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00008b15</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  H..H....E.......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0040</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8b050000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 000001c2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8b45f801</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  .............E..</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0050</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c28b45fc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 01d089c7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> e8000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00b80000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ..E.............</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0060</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0000c9c3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                             ....</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .data:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 54000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 55000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                    T...U...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .rodata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 25640a00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                             %d..</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .comment:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00474343</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 3a202855</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 62756e74</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 75203133</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  .GCC:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (Ubuntu </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">13</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0010</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 2e322e30</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 2d323375</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 62756e74</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 75342920</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  .2.0-23ubuntu4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0020</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 31332e32</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 2e3000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      13.2.0.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .note.gnu.property:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 04000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 05000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 474e5500</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ............GNU.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0010</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 020000c0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 04000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 03000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ................</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Contents</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .eh_frame:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 14000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 017a5200</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 01781001</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  .........zR..x..</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0010</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1b0c0708</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 90010000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1c000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1c000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ................</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0020</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 2b000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00450e10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8602430d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ....+....E....C.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0030</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 06620c07</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 08000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1c000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 3c000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  .b..........</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0040</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 39000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00450e10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8602430d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ....9....E....C.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0050</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 06700c07</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 08000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                    .p......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disassembly</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .text:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000000</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">func</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">1&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   0:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   f3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fa</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             endbr64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   4:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   55</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      push</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   %rbp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   5:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> e5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %rsp,%rbp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   8:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 83</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ec</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             sub</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    $0x10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%rsp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   c:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 7d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %edi,-0x4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">%rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   f:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   8b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 45</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    -0x4(%rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),%eax</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  12:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c6</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %eax,%esi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  14:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8d</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 05</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    lea</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0x0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">%rip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%rax</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        # 1b &lt;func1+0x1b&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  1b:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %rax,%rdi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  1e:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   b8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    $0x0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%eax</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  23:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   e8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          call</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   28</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">func1+0x2</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">8&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  28:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   90</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      nop</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  29:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   c9</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      leave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  2a:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   c3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      ret</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">000000000000002b</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mai</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  2b:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   f3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fa</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             endbr64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  2f:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   55</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      push</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   %rbp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  30:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> e5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %rsp,%rbp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  33:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   48</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 83</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ec</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             sub</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    $0x10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%rsp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  37:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   c7</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 45</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> f8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 01</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    movl</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">   $0x1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,-0x8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">%rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  3e:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   8b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 15</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       mov</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0x0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">%rip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%edx</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        # 44 &lt;main+0x19&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  44:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   8b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 05</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       mov</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0x0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">%rip</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%eax</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        # 4a &lt;main+0x1f&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  4a:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %eax,%edx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  4c:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   8b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 45</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> f8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    -0x8(%rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),%eax</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  4f:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %eax,%edx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  51:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   8b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 45</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                mov</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    -0x4(%rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),%eax</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  54:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> d0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %edx,%eax</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  56:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   89</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   mov</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    %eax,%edi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  58:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   e8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          call</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   5d</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">main+0x3</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">2&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  5d:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   b8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    $0x0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,%eax</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  62:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   c9</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      leave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  63:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   c3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      ret</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>-s: 将所有段的内容以十六进制的方式打印<br> -d: 将所有包含指令的段反汇编</p></div><h3 id="_3-2-数据段和只读数据段" tabindex="-1"><a class="header-anchor" href="#_3-2-数据段和只读数据段"><span>3.2 数据段和只读数据段</span></a></h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>.data section: 已初始化的全局变量和局部静态变量</p></div><p>SimpleSection.c代码中一共有两个这样的变量(global_init_var, static_var),所以.data段的大小正好为8个字节。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>.rodata section: 存放只读数据(const变量,字符串字面量)</p></div><p>SimpleSection.c代码中用在调用printf时用到了字符字面量&quot;%d\n&quot;,它是一种只读数据,所以它被放到了.rodata段。所以.rodata段的大小正好为四字节(字符串结尾包含字符串结束符)。</p><h3 id="_3-3-bss段" tabindex="-1"><a class="header-anchor" href="#_3-3-bss段"><span>3.3 bss段</span></a></h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>.bss section: 未初始化的全局变量和局部静态变量(默认值为0),初始化为0的全局变量和局部静态变量</p></div><p>SimpleSection.c代码中一共有两个这样的变量(global_uninit_var, static_var2),所以.data段的大小正好为8个字节。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>可以给gcc选项加入-fcommon使未初始化的全局变量被定义为一个&quot;COMMON&quot;符号，注意对于初始化为0的全局变量则不行。</p></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -fcommon</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">readelf</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Symbol</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;.symtab&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> contains</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 13</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> entries:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   Num:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Value</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          Size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Bind</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   Vis</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      Ndx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Name</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     0:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NOTYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  UND</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     1:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FILE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ABS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.c</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     2:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .text</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     3:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .data</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     4:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .bss</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     5:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .rodata</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     6:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     7:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var2.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     8:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_init_var</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     9:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  COM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_uninit_var</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    10:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    43</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FUNC</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> func1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    11:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NOTYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  UND</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> printf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    12:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 000000000000002b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    57</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FUNC</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-其它段" tabindex="-1"><a class="header-anchor" href="#_3-3-其它段"><span>3.3 其它段</span></a></h3><figure><img src="/image/linker/chapter02/其他段.png" alt="其它段" tabindex="0" loading="lazy"><figcaption>其它段</figcaption></figure><h2 id="_4-elf文件结构描述" tabindex="-1"><a class="header-anchor" href="#_4-elf文件结构描述"><span>4. ELF文件结构描述</span></a></h2><div class="hint-container note"><p class="hint-container-title">注</p><p>ELF目标文件的最前部是ELF文件头（ELF Header）,它包含了描述整个文件的基本属性。仅接着是ELF各个段。其中ELF文件中与段有关的重要结构就是段表（Section Header Table），该表描述了ELF文件包含的所有段的信息，比如每个段的段名、段的长度、在文件中的偏移、读写权限及段的其它属性。</p></div><figure><img src="/image/linker/chapter02/ELF文件结构.png" alt="ELF文件结构" tabindex="0" loading="lazy"><figcaption>ELF文件结构</figcaption></figure><h3 id="_4-1-文件头" tabindex="-1"><a class="header-anchor" href="#_4-1-文件头"><span>4.1 文件头</span></a></h3><p>通过使用<mark>readelf -h</mark>指令即可查看ELF文件头</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">readelf</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ELF</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Header:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  Magic:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   7f</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 45</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4c</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 46</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 02</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 01</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 01</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  Class:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                             ELF64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  Data:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">                              2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;s complement, little endian</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Version:                           1 (current)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  OS/ABI:                            UNIX - System V</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ABI Version:                       0</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Type:                              REL (Relocatable file)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Machine:                           Advanced Micro Devices X86-64</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Version:                           0x1</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Entry point address:               0x0</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Start of program headers:          0 (bytes into file)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Start of section headers:          1032 (bytes into file)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Flags:                             0x0</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Size of this header:               64 (bytes)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Size of program headers:           0 (bytes)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Number of program headers:         0</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Size of section headers:           64 (bytes)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Number of section headers:         14</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Section header string table index: 13</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ELF文件头定义了</p><ul><li>ELF魔数</li><li>文件机器字节长度</li><li>数据存储方式</li><li>版本</li><li>运行平台</li><li>ABI版本</li><li>ELF重定位类型</li><li>硬件平台</li><li>硬件平台版本</li><li>入口地址</li><li>程序入口和长度</li><li>段表位置和长度</li><li>段数量</li></ul><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// /usr/include/elf.h</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;">	e_ident</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[EI_NIDENT];</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">	/* Magic number and other info */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half	e_type;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">			/* Object file type */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half	e_machine;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Architecture */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word	e_version;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Object file version */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Addr	e_entry;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Entry point virtual address */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Off	e_phoff;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Program header table file offset */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Off	e_shoff;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section header table file offset */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word	e_flags;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Processor-specific flags */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half	e_ehsize;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* ELF header size in bytes */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half	e_phentsize;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Program header table entry size */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half	e_phnum;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Program header table entry count */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half	e_shentsize;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section header table entry size */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half	e_shnum;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section header table entry count */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Half	e_shstrndx;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section header string table index */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} Elf64_Ehdr;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/image/linker/chapter02/ELF文件头结构成员含义.png" alt="ELF文件头结构成员含义" tabindex="0" loading="lazy"><figcaption>ELF文件头结构成员含义</figcaption></figure><h4 id="_4-1-2-文件类型" tabindex="-1"><a class="header-anchor" href="#_4-1-2-文件类型"><span>4.1.2 文件类型</span></a></h4><figure><img src="/image/linker/chapter02/文件类型.png" alt="文件类型" tabindex="0" loading="lazy"><figcaption>文件类型</figcaption></figure><h4 id="_4-1-3-机器类型" tabindex="-1"><a class="header-anchor" href="#_4-1-3-机器类型"><span>4.1.3 机器类型</span></a></h4><figure><img src="/image/linker/chapter02/机器类型.png" alt="机器类型" tabindex="0" loading="lazy"><figcaption>机器类型</figcaption></figure><h3 id="_4-2-段表" tabindex="-1"><a class="header-anchor" href="#_4-2-段表"><span>4.2 段表</span></a></h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>段表用于保存这些段的基本属性结构。</p></div><p>使用<mark>objdump -h</mark>来查看ELF文件中包含的段，但是只是把ELF文件中关键的段显示了出来。可以使用<mark>readelf -S</mark>指令来显示ELF文件的各种段表结构</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">readelf</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">There</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 14</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> headers,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> starting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> offset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0x408:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Section</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Headers:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [Nr] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">              Type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             Address</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           Offset</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       Size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">              EntSize</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          Flags</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Link</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Info</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Align</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 0]                   </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">NULL</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">             0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 1] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.text</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000040</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000064</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  AX</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 2] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.rela.text</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        RELA</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">             0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000002e8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000078</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000018</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   I</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      11</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 3] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.data</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000a4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000008</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  WA</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 4] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.bss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">              NOBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000ac</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  WA</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 5] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.rodata</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000ac</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   A</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 6] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.comment</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000b0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000027</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000001</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  MS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 7] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.note.GNU-stack</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000d7</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 8] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.note.gnu.pr[...]</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NOTE</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">             0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000d8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000020</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   A</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [ 9] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.eh_frame</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         PROGBITS</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">         0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  000000f8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000058</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   A</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [10] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.rela.eh_frame</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    RELA</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">             0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000360</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000030</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000018</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   I</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      11</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     9</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [11] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.symtab</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           SYMTAB</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000150</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000138</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000018</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">          12</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [12] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.strtab</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           STRTAB</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000288</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000060</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [13] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">.shstrtab</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         STRTAB</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  00000390</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       0000000000000074</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Key</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Flags:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  W</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (write), A (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), X (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), M (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">merge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), S (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">strings</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), I (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  L</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (link </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">order</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), O (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">extra</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> processing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> required</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), G (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), T (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">TLS</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  C</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (compressed), x (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">unknown</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), o (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">OS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> specific</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), E (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exclude</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  D</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (mbind), l (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">large</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), p (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">processor</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> specific</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>段表的结构以Elf64_Shdr结构的数组形式进行存储,数组元素个数为段个数，每个Elf64_Shdr对应一个段属性描述。所以每个Elf64_Shdr又被称为段描述符。<br> 第一个元素是无效段描述符，它的类型为&quot;NULL&quot;，除此之外每个描述符对应一个段。所以SimpleSection.o共有10个有效段。</p></div><h4 id="_4-2-1-段描述符的结构" tabindex="-1"><a class="header-anchor" href="#_4-2-1-段描述符的结构"><span>4.2.1 段描述符的结构</span></a></h4><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// /usr/include/elf.h</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word	sh_name;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section name (string tbl index) */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word	sh_type;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section type */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Xword	sh_flags;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section flags */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Addr	sh_addr;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section virtual addr at execution */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Off	sh_offset;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section file offset */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Xword	sh_size;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section size in bytes */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word	sh_link;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Link to another section */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word	sh_info;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Additional section information */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Xword	sh_addralign;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section alignment */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Xword	sh_entsize;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Entry size if section holds table */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} Elf64_Shdr;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/image/linker/chapter02/Elf64_Shdr结构含义.png" alt="Elf64_Shdr" loading="lazy"><br> 段表结构解析<br><img src="/image/linker/chapter02/段结构分析.png" alt="段结构解析" loading="lazy"></p><div class="hint-container note"><p class="hint-container-title">注</p><p>elf文件头中指出了段表位于文件的偏移(Elf64_Ehdr的e_shoff元素)为1032(0x408)，代码段(.text)位于elf文件头后所以elf文件头的大小正好为代码段的偏移0x40(64)字节，段表的最后一个元素(.shstrtab)的偏移量为0x390文件大小为0x74。而0x408 = 0x390 + 0x74 + 0x04正好是段表在elf文件中的偏移(之所以+0x04是因为内存对齐的原因)。</p></div><h5 id="_4-2-1-1-段的类型-sh-type" tabindex="-1"><a class="header-anchor" href="#_4-2-1-1-段的类型-sh-type"><span>4.2.1.1 段的类型(sh_type)</span></a></h5><div class="hint-container tip"><p class="hint-container-title">提示</p><p>对于编译器和链接器来说，主要决定段的属性的是段的类型(sh_type)和段的标志位(sh_flags)</p></div><figure><img src="/image/linker/chapter02/段的类型.png" alt="段的类型" tabindex="0" loading="lazy"><figcaption>段的类型</figcaption></figure><h5 id="_4-2-1-2-段的标志位-sh-flags" tabindex="-1"><a class="header-anchor" href="#_4-2-1-2-段的标志位-sh-flags"><span>4.2.1.2 段的标志位(sh_flags)</span></a></h5><div class="hint-container tip"><p class="hint-container-title">提示</p><p>决定了该段在进程虚拟地址空间中的属性，比如是否可写，是否可执行等。</p></div><figure><img src="/image/linker/chapter02/段的标志位.png" alt="段的标志位" tabindex="0" loading="lazy"><figcaption>段的标志位</figcaption></figure><h5 id="_4-2-1-3-段的链接信息-sh-link、sh-info" tabindex="-1"><a class="header-anchor" href="#_4-2-1-3-段的链接信息-sh-link、sh-info"><span>4.2.1.3 段的链接信息(sh_link、sh_info)</span></a></h5><div class="hint-container tip"><p class="hint-container-title">提示</p><p>只有段的类型是与链接(动态链接、静态链接、重定位表、符号表等)相关时这两个成员才会有意义。</p></div><figure><img src="/image/linker/chapter02/段的链接信息.png" alt="段的链接信息" tabindex="0" loading="lazy"><figcaption>段的链接信息</figcaption></figure><h3 id="_4-3-重定位表" tabindex="-1"><a class="header-anchor" href="#_4-3-重定位表"><span>4.3 重定位表</span></a></h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>在SimpleSection.o中有一个叫做&quot;.rela.text&quot;的段, 它的类型(sh_type)为&quot;SH_RELA&quot;, 也就是说它是一个重定位表。<br> 对于每个需要重定位的段，都会有一个相应的重定位表。比如&quot;.rela.text&quot;是&quot;.text&quot;的重定位表。<br> 一个重定位表同时也是elf的一个段, 那么这个段的类型(sh_type)就是&quot;SHL_REL&quot;, 它的&quot;sh_link&quot;表示符号表的下标, &quot;sh_info&quot;表示它作用于那个段。</p></div><figure><img src="/image/linker/chapter02/重定位表.png" alt="重定位表" tabindex="0" loading="lazy"><figcaption>重定位表</figcaption></figure><h3 id="_4-4-字符串表" tabindex="-1"><a class="header-anchor" href="#_4-4-字符串表"><span>4.4 字符串表</span></a></h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>elf文件中用到了很多字符串，比如段名、变量名等。因为字符串的长度往往是不定的，所以用固定的结构来表示它比较困难。一种常见的做法是把字符串集中起来存放到一个表，然后使用字符串在表中的偏移来引用字符串。<br> .strtab: 字符串表(string table)<br> .shstrtab: 段表字符串表(section header string table)</p></div><p><img src="/image/linker/chapter02/字符串表.png" alt="字符串表" loading="lazy"><br><img src="/image/linker/chapter02/段表字符串表分析.png" alt="段表字符串表" loading="lazy"></p><h2 id="_5-链接的接口-符号-symbol" tabindex="-1"><a class="header-anchor" href="#_5-链接的接口-符号-symbol"><span>5. 链接的接口-符号(Symbol)</span></a></h2><div class="hint-container tip"><p class="hint-container-title">提示</p><p>链接的过程就是把多个不同的目标文件之间相互衔接的过程。这个相互衔接的过程实际上是目标文件之间对地址的引用。<br> 比如文件B用到了目标A中的函数&quot;foo&quot;, 那么我们就称文件A<code>定义(define)</code>了函数&quot;foo&quot;, 称目标文件B<code>引用(refrence)</code>了目标文件A中的函数&quot;foo&quot;。这两个概念同样适用于变量。<br> 在链接中将函数和变量称为<code>符号(Symbol)</code>, 函数名和变量名称为<code>符号名(Symbol Name)</code><br><code>符号是链接中的粘合剂</code>, 整个链接的过程基于符号才能正确完成。<br> 每一个目标文件都有一个相应的<code>符号表(Symbol Table)</code>对符号进行管理, 该表记录了目标文件中所用的所有符号。每个定义的符号都有一个对应的值, 叫做<code>符号值(Symbol Value)</code>, 对于<code>变量和函数</code>来说, 符号值就是它们的<code>地址</code>。除了函数和变量外，还存在其它几种不常用的符号。</p></div><ul><li>定义在目标文件的全局符号，可以被其它目标文件引用</li><li>在本文件中引用的全局符号，却没有在本文件中定义，一般叫做<code>外部符号(External Symbol)</code>，也被称为符号引用</li><li>段名，由编译器生成，它的值就是该段的起始地址。(.text, .data)</li><li>局部符号，只在编译器内部可见。(SimpleSection.o文件的static_var和static_var2)</li><li>行号信息，即目标文件指令与源代码中代码行的对应关系，可选。</li></ul><p>使用nm指令查看符号结果</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">nm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> T</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> func1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> D</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_init_var</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000004</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> C</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_uninit_var</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">000000000000002b</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> T</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                 U</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> printf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000004</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0000000000000000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> b</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var2.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-1-elf符号表结构" tabindex="-1"><a class="header-anchor" href="#_5-1-elf符号表结构"><span>5.1 ELF符号表结构</span></a></h3><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// /usr/include/elf.h</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Word	st_name;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Symbol name (string tbl index) */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	st_info;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Symbol type and binding */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> st_other;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Symbol visibility */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Section	st_shndx;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Section index */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Addr	st_value;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Symbol value */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  Elf64_Xword	st_size;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">		/* Symbol size */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} Elf64_Sym;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/image/linker/chapter02/ELF符号表结构.png" alt="ELF符号表结构" tabindex="0" loading="lazy"><figcaption>ELF符号表结构</figcaption></figure><h4 id="_5-1-1-符号类型和绑定类型-st-info" tabindex="-1"><a class="header-anchor" href="#_5-1-1-符号类型和绑定类型-st-info"><span>5.1.1 符号类型和绑定类型(st_info)</span></a></h4><div class="hint-container tip"><p class="hint-container-title">提示</p><p>低4位表示<code>符号类型(Symbol Type)</code>, 高28位表示<code>符号绑定信息(Symbol Binding)</code></p></div><figure><img src="/image/linker/chapter02/符号类型和绑定.png" alt="符号类型和绑定" tabindex="0" loading="lazy"><figcaption>符号类型和绑定</figcaption></figure><h4 id="_5-1-2-符号所在段-st-shndx" tabindex="-1"><a class="header-anchor" href="#_5-1-2-符号所在段-st-shndx"><span>5.1.2 符号所在段(st_shndx)</span></a></h4><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果符号定义在本目标文件中，那么这个成员表示符号所在的段在段表中的下标，如果符号不是定义在本目标文件中，或者对于有些特殊符号，sh_shndx的值会有些特殊。</p></div><figure><img src="/image/linker/chapter02/符号所在段.png" alt="符号所在段" tabindex="0" loading="lazy"><figcaption>符号所在段</figcaption></figure><h4 id="_5-1-3-符号值-st-value" tabindex="-1"><a class="header-anchor" href="#_5-1-3-符号值-st-value"><span>5.1.3 符号值(st_value)</span></a></h4><div class="hint-container tip"><p class="hint-container-title">提示</p><p>每个符号都有一个对应的值，如果这个符号是一个函数或变量的定义，那么符号的值就是这个函数或变量的地址。</p></div><ul><li>在目标文件中，如果是符号的定义并且该符号不是“<mark>COMMON块</mark>”类型的，则st_value表示<mark>该符号在段中的偏移</mark>。比如SimpleSection.o中的&quot;func1&quot;、&quot;main&quot;、&quot;global_init_var&quot;。</li><li>在目标文件中，如果符号是&quot;COMMON块&quot;，st_value表示该符号的对齐属性。比如SimpleSection.o中的&quot;global_uninit_var&quot;。</li><li>在可执行文件中，st_value表示符号的虚拟地址。<br> 使用readelf -s查看符号表</li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 注意编译时使用了-fcommon编译选项</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">readelf</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Symbol</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;.symtab&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> contains</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 13</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> entries:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">   Num:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Value</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          Size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Bind</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   Vis</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      Ndx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Name</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     0:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NOTYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  UND</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     1:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FILE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  ABS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SimpleSection.c</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     2:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .text</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     3:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .data</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     4:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .bss</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     5:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SECTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .rodata</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     6:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     7:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> static_var2.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     8:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_init_var</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">     9:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000004</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJECT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  COM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global_uninit_var</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    10:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    43</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FUNC</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> func1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    11:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0000000000000000</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NOTYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  UND</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> printf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    12:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 000000000000002b</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    57</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FUNC</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    GLOBAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEFAULT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-2-特殊符号" tabindex="-1"><a class="header-anchor" href="#_5-2-特殊符号"><span>5.2 特殊符号</span></a></h3><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// SpecialSymbol.c</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &lt;stdio.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">extern</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> __executable_start</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">extern</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> etext</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, _etext</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, __etext</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">extern</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> edata</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, _edata</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">extern</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, _end</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  printf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Executable Start </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">%X</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, __executable_start);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  printf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Text End </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">%X</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> %X</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> %X</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, etext, _etext, __etext);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  printf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Data End </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">%X</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> %X</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, edata, _edata);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  printf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Executable End </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">%X</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> %X</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, end, _end);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">./SpecialSymbol</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Executable</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Start</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9004000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Text</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> End</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9005205</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9005205</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9005205</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Data</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> End</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9008010</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9008010</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Executable</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> End</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9008018</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9008018</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>__executable_start: 程序起始地址，注意不是入口地址。<br> etext, _etext, __etext: 代码段结束地址。<br> edata, <em>edata: 数据段结束地址。<br> end, <em>end: 程序结束地址。<br> 地址都为虚拟地址。<br> ### 5.3 符号修饰与函数签名<br> [!tip]<br> UNIX下c语言规定：c语言源代码文件中的所有全局的变量和函数经过编译后，相应的符号名前加上下划线&quot;</em>&quot;。比如一个c函数&quot;foo&quot;，当它经过编译后的符号名就为&quot;<em>foo&quot;。但是当程序规模很大时仍然会出现明明冲突的问题，于是像c++增加了==命名空间(namespace)==的方法来解决多模块的符号冲突问题。<br> 现在的Linux下的GCC编译器中，默认情况下已经去掉了在c语言符号前加&quot;</em>&quot;的这种方式。GCC编译器也可以通过==&quot;-fleading-underscore&quot;<mark>或者</mark>&quot;-fno-leading-underscore&quot;==来打开和关闭是否在c语言符号前加上&quot;</em>&quot;</p></div><h4 id="_5-3-1-c-符号修饰" tabindex="-1"><a class="header-anchor" href="#_5-3-1-c-符号修饰"><span>5.3.1 c++ 符号修饰</span></a></h4><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">float</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">float</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> C</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> C2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> N</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> C</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">注</p><p>函数签名(Function Signature): 包含了一个函数的信息，包括函数名、参数类型、它所在的类和名称空间及其它信息。<br> 名称修饰(Name Decoration): 在编译器及连接器处理符号时，使用某种名称修饰的方法，使得每个函数签名对应一个修饰后名称(Decorated Name)。</p></div><figure><img src="/image/linker/chapter02/c++名称修饰.png" alt="c++名称修饰" tabindex="0" loading="lazy"><figcaption>c++名称修饰</figcaption></figure><div class="hint-container tip"><p class="hint-container-title">提示</p><p>所有符号都以&quot;_Z&quot;开头，对于嵌套的名字(在名称空间或在类里面的)，后面紧跟&quot;N&quot;，然后是各个名称空间和类的名字，每个名字前是名字字符串长度，再以&quot;E&quot;结尾。比如N::C::func经过名称修饰后就是_ZN1N1C4funcE。对于一个函数来说，它的参数列表紧跟在&quot;E&quot;后面，对于int类型来说,字母就是&quot;i&quot;。所以整个N::C::func(int)函数签名经过修饰为_ZN1N1C4funcEi。</p></div><div class="hint-container note"><p class="hint-container-title">注</p><p>可以通过&quot;c++filt&quot;的工具来解析被修饰的名称。</p></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">c++filt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> _ZN1N1C4funcEi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">N::C::func(int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>c++中的全局变量和静态变量也有同样的机制。比如foo命名空间下的bar变量(foo::bar)，经过修饰后的名字为: _ZN3far3barE。可以注意到变量的类型并没有加入到修饰后的名称中去。所以不论这个变量是整形还是浮点型甚至是全局对象，它的名称都是一样的。<br> 名称修饰机制也被用来防止静态变量的名字冲突。比如main()函数里面的静态变量foo，和func()函数的静态变量foo会被GCC编译器会将他们修饰为：_ZZ4mainE3foo和_ZZ4funcE3foo。</p></div><h3 id="_5-4-extern-c" tabindex="-1"><a class="header-anchor" href="#_5-4-extern-c"><span>5.4 extern &quot;C&quot;</span></a></h3><div class="hint-container note"><p class="hint-container-title">注</p><p>c++编译器会将extern &quot;C&quot;的大括号内部的代码当作c语言代码处理。所以c++名称修饰会对其不起作用。</p></div><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// func和var不会被c++的名称修饰规则修饰。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">extern</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> var;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 或者写成</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">extern</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;C&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">extern</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;C&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> var;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" data-title="cpp" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ManualNameMangling.cc</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// g++ ManualNameMangling.cc -o ManualNameMangling</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &lt;stdio.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> myname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> var </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 42</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">extern</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;C&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> double</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> _ZN6myname3varE;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  printf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#ABB2BF;">myname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">::var);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">./ManualNameMangling</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">42</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-5-强符合与弱符号" tabindex="-1"><a class="header-anchor" href="#_5-5-强符合与弱符号"><span>5.5 强符合与弱符号</span></a></h3><div class="hint-container note"><p class="hint-container-title">注</p><p>深入理解计算机系统(csapp)一书中也有讲解。了解本小节将有助于帮助理解链接过程中为什么会出现<code>重复定义</code>的问题。</p></div><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// a.c</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> global </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// b.c</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> global </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 由于global重复定义链接时将会出现重定义错误。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>符号的定义通常被称为<mark>强符号(Strong Symbol)</mark>。有些符号的定义也被称为<mark>弱符号(Weak Symbol)</mark></p><div class="hint-container note"><p class="hint-container-title">注</p><p>c/c++编译器默认函数和初始化了的全局变量为强符号，未初始化的全局变量为弱符号。可以通过GCC编译器提供的&quot;<strong>attribute</strong>((weak))&quot; 来定义任何一个强符号为弱符号。<br> 需要注意的是：强符号和弱符号都是针对定义的，不是针对符号的引用。</p></div><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">extern</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ext;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> // 这是一个引用，所以即不是强符号也不是弱符号。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> weak;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> // 弱符号</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> strong </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> // 强符号</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">__attribute__</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">weak</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) weak2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> // 弱符号</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 强符号</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>连接器按如下规则处理与选择被多次定义的全局符号</p><div class="hint-container tip"><p class="hint-container-title">提示</p><ul><li>不允许被多次定义(既不同的目标文件中不能有同名的强符号)，如果出现多个强符号定义，则链接器报符号重定义错误。</li><li>如果一个符号在某个文件中是强符号，在其它文件为弱符号，那么选强符号。</li><li>如果一个符号在所有目标文件中都是弱符号，那么选其中占用空间最大的一个。比如文件A声明符号(未初始化)global为int(4byte)，目标文件B声明符号(未初始化)global为double(8byte)。当A和B链接时，符号global占8byte。(最好不要这样负责会出现一些意想不到的bug，而且很难发现)</li></ul></div><h4 id="弱引用和强引用" tabindex="-1"><a class="header-anchor" href="#弱引用和强引用"><span>弱引用和强引用</span></a></h4><div class="hint-container tip"><p class="hint-container-title">提示</p><p><mark>强引用(Strong Reference)</mark>: 对外部目标文件的符号引用在目标文件被最终链接成可执行文件时，他们需要被正确决议，如果没有找到该符号的定义，链接器就会报服啊后未定义的错误，这种被称为<mark>强引用(Strong Reference)</mark>。<br><mark>弱引用(Weak Reference)</mark>: 在处理弱引用时，如果该符号有定义，则连接器将该符号的引用决议；如果该符号未被定义，则连接器对于该引用不报错。<br> 对于未定义的弱引用，连接器默认其为0，或者是一个特殊的值，以便于程序代码能够识别。</p></div><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 通过使用__attribute__ ((weakref))声明对一个外部函数的引用为弱引用。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">__attribute__</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ((</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">weakref</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> foo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (foo) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">foo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// pthread.c</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 通过使用__attribute__ ((weakref))判断是否链接到pthread库。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &lt;stdio.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &lt;pthread.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> pthread_create</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">pthread_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> const</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> pthread_attr_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">__attribute__</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ((</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">weak</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (pthread_create) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    printf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This is multi-thread version!</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    printf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This is single-thread version!</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pthread.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">./pt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">This</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> single-thread</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version!</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pthread.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pt</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -lpthread</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">./pt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">This</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> multi-thread</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version!</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-6-调试信息" tabindex="-1"><a class="header-anchor" href="#_5-6-调试信息"><span>5.6 调试信息</span></a></h3><div class="hint-container note"><p class="hint-container-title">注</p><p>可以使用readelf查看<code>debug</code>相关的段</p></div></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/hncat/edit/main/src/cs/linker/chapter02.md" aria-label="在 GitHub 上编辑此页" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><!----></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: v19991123v@163.com">far</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/cs/linker/chapter01.html" aria-label="第一章 编译和链接"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->第一章 编译和链接</div></a><a class="route-link auto-link next" href="/cs/linker/chapter03.html" aria-label="第三章 静态链接"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">第三章 静态链接<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright © 2024 Mr.far </div></footer></div><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.efa7a504.js" defer></script><script src="/assets/js/783.700e2d1b.js" defer></script><script src="/assets/js/app.85ac5ea2.js" defer></script>
  </body>
</html>
