---
title: 第2章 链路层
date: 2025-09-01
tags:
    - 计算机基础
    - 计算机网络
categories: 计算机网络
isOriginal: true
order: 2
dir:
    order: 2
---
## 2.1 引言
> [!important]
> 链路层的三个目的
> 1. 位IP模块发送和接收IP数据报。
> 2. 为ARP模块发送ARP请求和接收ARP应答。
> 3. 为RARP发送RARP请求和接收RARP应答。

## 2.2 以太网和IEEE 802封装
两种帧格式都采用`48bit(6byte)的目的地址和源地址(802.3允许使用16 bit的地址，但一般是48 bit地址)，即硬件地址(mac地址)。ARP和RARP协议对32bit的ip地址和48bit的mac地址进行映射。`
接下来的2个字节在两种帧格式中互不相同。在802标准定义的帧格式中，`长度字段是指它后续数据的字节长度，但不包括CRC检验码。`以太网的类型字段定义了后续数据的类型。在802标准定义的帧格式中，类型字段则由后续的`子网接入协议（Sub-network Access Protocol，SNAP）的首部给出。`
`在以太网帧格式中，类型字段之后就是数据`；而在802帧格式中，跟随在后面的是`3字节的802.2LLC和5字节的802.2SNAP。目的服务访问点（Destination Service Access Point, DSAP）和源服务访问点（Source Service Access Point, SSAP）的值都设为0xaa。Ct rl字段的值设为3。随后的3个字节org code都置为0。`再接下来的2个字节类型字段和以太网帧格式一样（其他类型字段值可以参见RFC 1340[Reynolds and Postel 1992]）。
CRC字段用于`帧内后续字节差错的循环冗余码检验（检验和）（它也被称为FCS或帧检验序列）。`

![图2-1 IEEE 802.2/802.3（RFC 1042）和以太网的封装格式（RFC 894）](/image/tcp_ip/chapter02/2-1.png)

> [!important]
> 802.3标准定义的帧和以太网的帧都有最小长度要求。802.3规定数据部分必须至少为38字节，而对于以太网，则要求最少要有46字节。为了保证这一点，必须在不足的空间插入填充（pad）字节。

## 2.4 环回接口
大多数的产品都支持环回接口（Loopback Interface），`以允许运行在同一台主机上的客户程序和服务器程序通过TCP/IP进行通信。`A类网络号127就是为环回接口预留的。根据惯例，`大多数系统把IP地址127.0.0.1分配给这个接口，并命名为localhost。一个传给环回接口的IP数据报不能在任何网络上出现。`
![图2-2 环回接口处理ip数据报的过程](/image/tcp_ip/chapter02/2-2.png)

> [!tip]
> 1. 传给环回地址（一般是127.0.0.1）的任何数据均作为IP输入。
> 2. 传给广播地址或多播地址的数据报复制一份传给环回接口，然后送到以太网上。这是因为广播传送和多播传送的定义包含主机本身。
> 3. 任何传给该主机IP地址的数据均送到环回接口。

## 2.5 MTU(最大传输单元)
